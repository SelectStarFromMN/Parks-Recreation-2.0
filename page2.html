<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Parks and Recreation</title>
    <style type="text/css">
        button,
        div,
        form,
        input {
            margin: 10px;
        }
    </style>

    <!-- Link to jQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Link to Bootstrap -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
        crossorigin="anonymous">
    
</head>

<body>

    <div class="container">
        <h1>National Parks Search</h1>
        <div id="buttons-view"></div>
        <div id="parks-view"></div>

        <div class="panel panel-primary">
            <div class="panel-heading">
                <h3 class="panel-title">
                    <strong>National Park Sites in </strong>
                    <span id="table-header-state"></span>
                </h3>
            </div>
            <div class="panel-body border border-dark">
                <table id="parks-table" class="table table-hover">
                    <thead>
                        <tr>
                            <th scope="col">Park Code</th>
                            <th scope="col">Designation</th>
                            <th scope="col">Description</th>
                            <th scope="col">lat/long</th>
                        </tr>
                    </thead>
                    <tbody id="parks-table-body">
                    </tbody>
                </table>
            </div>
        </div>


        <script type="text/javascript">

            // var states = ["Wisconsin", "Minnesota", "Iowa", "Michigan"];
            var states = ["WI", "MN", "IA", "MI"];

            function displayParkInfo(state) {


                // var state = $(this).attr("data-state");
                var queryURL = "https://developer.nps.gov/api/v1/parks?stateCode="
                    + state
                    + "&api_key=AIE9qvgTDNGyGQtR69wMNpjX7oRVXmYD1bFPlnmU";

                // Creating an AJAX call
                $.ajax({
                    url: queryURL,
                    method: "GET"
                }).then(function (response) {
                    // console.log(response);
                    // console.log(response.data)

                    // Clear the table
                    $("#parks-table-body").empty();
                    for (var i = 0; i < response.data.length; i++) {
                        // console.log("Park-" + (i + 1) + " " + response.data[i])
                        var parkObj = response.data[i];
                        $("#parks-table-body").append(`<tr class="park-row"><td>${parkObj.parkCode}</td><td>${parkObj.designation}</td><td>${parkObj.description}</td><td>${parkObj.latLong}</td></tr>`)

                    }

                });

            }

            function renderButtons() {
                $("#buttons-view").empty();

                // Looping through the array of states
                for (var i = 0; i < states.length; i++) {
                    var a = $("<button>");
                    // Adding a class
                    a.addClass("state-btn");
                    // Adding a data-attribute
                    a.attr("data-name", states[i]);
                    // Providing the initial button text
                    a.text(states[i]);
                    // Adding the button to the buttons-view div
                    $("#buttons-view").append(a);
                }
            }
            renderButtons();


            // Adding a click event listener
            // $(document).on("click", ".state-btn", displayParkInfo($(this).attr('data-name')));
            $(document).on("click", ".state-btn", function () {
                // console.log("State: " + $(this).attr('data-name'));
                var stateClicked = $(this).attr('data-name');
                $("#table-header-state").text(stateClicked);
                displayParkInfo(stateClicked);
            })

        </script>
    </div>
</body>

</html>